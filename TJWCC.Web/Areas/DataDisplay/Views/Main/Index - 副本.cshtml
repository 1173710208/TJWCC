@{
    ViewBag.Title = "主页";
    Layout = "~/Views/Shared/_Main.cshtml";
}
<script>
    $(document).ready(function () {

    });
</script>

<style>
    .total-text {
        font-size: 14px;
    }

    .total-value {
        color: white;
        font-size: 28px;
    }

    .icon-total {
        display: block;
        float: left;
        height: 5px;
        width: 5px;
        border-radius: 2.5px;
        margin-top: 6px;
        margin-right: 6px;
    }
</style>

<div class="container-fluid">
    <!--头部-->
    <div class="row" style="min-height:78px;vertical-align:middle;line-height:78px;">
        <div class="col-md-12 title-box">
            <div class='title-div title-left'></div>
            <span class="text-center" style="font-size:33px;color:white;">三博水科技NB-IoT水表集抄平台</span>
            <div class='title-div title-right'></div>
            <div id="title-btn">
                <a class="pull-left" href="/Home/Index"><span class="icon-GoBack"></span></a>        
                <a class="pull-right" href="/Login/OutLogin"><span class="icon-Exit"></span></a>
            </div>
        </div>
    </div>
    <!---中间部分-->
    <div class="row">
        <div class="col-md-3">
            <!-- 总水量/时间 -->
            <div class="box box-solid bg bg-one" id="box-time">
                <div class="box-body">
                    <!--时间-->
                    <div class="time">
                        <div>
                            <span id="time">-</span>
                        </div>
                        <div>
                            <span id="time-Hour1" class="icon-time">-</span>
                            <span id="time-Hour2" class="icon-time">-</span>
                            <span class="icon-time">:</span>
                            <span id="time-Minute1" class="icon-time">-</span>
                            <span id="time-Minute2" class="icon-time">-</span>
                            <span class="icon-time">:</span>
                            <span id="time-Second1" class="icon-time">-</span>
                            <span id="time-Second2" class="icon-time">-</span>
                        </div>
                    </div>
                    <!---总用水量-->
                    <div class="box box-solid  bg1">
                        <div class="box-header">
                            <h3 class="box-title">日抄收水量（吨）：</h3>
                        </div>
                        <div class="box-body">
                            <div class="text-center">
                                <span class="icon-Water"></span> <span id="TotalWater">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 在线率对比 -->
            <div class="box box-solid bg bg-one" id="box-0nline" style="position: relative;">
                <div class="box-body">
                    <div class="title-bg"><span>在线率对比</span></div>
                    <div id="OnlineChart" style="height:260px; position: absolute; top: 37px; width: calc(100% - 20px);">
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="box box-solid bg" id="box-map1">
                <div class="box-header " style="height:70px;">
                    <div class="col-md-3 center-block">
                        <div class="row center-block">
                            <div>
                                <img src='../../../Areas/DataDisplay/Content/img/ico-1.png'>
                                <span class="total-text">总表数(具)</span></div>
                            <div class="row center-block">
                                <span id="total-install" class="total-value">-</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="row  center-block">
                            <div>
                                <img src='../../../Areas/DataDisplay/Content/img/ico-2.png'>
                                <span class="total-text">在线(具)</span></div>
                            <div class="row center-block">
                                <span id="total-online" class="total-value">-</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3  center-block">
                        <div class="row  center-block">
                            <div>
                                <img src='../../../Areas/DataDisplay/Content/img/ico-3.png'>
                                <span class="total-text">离线(具)</span></div>
                            <div class="row center-block">
                                <span id="total-offline" class="total-value">-</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3  center-block">
                        <div class="row  center-block">
                            <div>
                                <img src='../../../Areas/DataDisplay/Content/img/ico-4.png'>
                                <span class="total-text">报警(条)</span></div>
                            <div class="row center-block">
                                <span id="total-alarm" class="total-value">-</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box-body">
                    <!--显示每个区域的相关信息-->
                    <div id="mapChart" style='width:100%;height:475px;'></div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <!--信号强度对比-->
            <div class="box box-solid bg bg-one" id="box-RSSI">
                <div class="box-body">
                    <div class="title-bg"><span>信号强度对比</span></div>
                    <div id="RSSIChart" style="height:185px;">
                    </div>
                </div>
            </div>
            <!-- 报警类型 -->
            <div class="box box-solid bg bg-one" id="box-alarm">
                <div class="box-body">
                    <div class="title-bg"><span>报警类型对比</span></div>
                    <div id="alarmChart" style="height:235px;">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 底部图表 -->
    <div class="row">
        <div class="col-md-12">
            <div class="box box-solid bg bg-two">
                <div class="box-body">
                    <div id="waterChart" style="min-height:230px;">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    //数据窗口变化后更新底部水量图表高度
    resizeWaterChart();
    //信号强度
    var RSSIChart = echarts.init(document.getElementById('RSSIChart'));
    //上线率分析
    var OnlineChart = echarts.init(document.getElementById('OnlineChart'));
    //在线率
    var OnlineRate = [],OnlineName = [];
    //报警
    var alarmChart = echarts.init(document.getElementById('alarmChart'));
    //用水量分析
    var waterChart = echarts.init(document.getElementById('waterChart'));
    //地图
    var mapChart = echarts.init(document.getElementById('mapChart'));

    $(function () {
        //标记点坐标
        let markedCoordinates = [[116.95220947265624,39.155023386732644],
        [116.99392318725586,39.151429239503564],
        [116.9820785522461,39.10249065043197]]

         //获取公司名称(全局变量)
        let corporateNameArr = []; //公司名称数组
        let allCorporateArr = []; // 接口返回全部数据
        $.ajax({
            url: "/SystemManage/Company/GetGridJson",
            type: "get",
            async: true,
            success: function (data) {
                allCorporateArr = JSON.parse(data);
                allCorporateArr.forEach(function(item,index){
                    corporateNameArr.push(item.CNAME)
                });
                //地图(引入js变量存储地图数据)
                {
                    echarts.registerMap('xiqing', index_map);
                    let geoCoordMap = {}//地图上的标记点显示位置（坐标）
                    let signData = [] //地图标记显示大小
                    //循环公司名称数组，并赋值
                    corporateNameArr.forEach(function(item,index){
                        geoCoordMap[item] = markedCoordinates[index]
                        let nameArr = {name:item,value:50}
                        signData.push(nameArr)
                    });
                    var convertData = function(signData) {
                        var res = [];
                        for (var i = 0; i < signData.length; i++) {
                            var geoCoord = geoCoordMap[signData[i].name];
                            if (geoCoord) {
                                res.push({
                                    name: signData[i].name,
                                    value: geoCoord.concat(signData[i].value)
                                });
                            }
                        }
                        return res;
                    };
                    option = {
                        tooltip: {
                            trigger: 'item',
                            borderColor: '#FFFFCC',
                            showDelay: 0,
                            hideDelay: 0,
                            enterable: true,
                            transitionDuration: 0,
                            extraCssText: 'z-index:100',
                            formatter: function(params, ticket, callback) {
                                //各区总水量
                                let dayWaterData = [];
                                $.ajax({
                                    url: "/DataDisplay/Main/GetBWaterByCname?cname=" + params.name,
                                    type: "get",
                                    async: false,
                                    success: function (data) {
                                        var JsonData = JSON.parse(data);
                                        $.each(JsonData["Series"], function (i, ele) {
                                            dayWaterData.push(ele.Data[0]);
                                        });
                                    }
                                });
                                
                                var dayWaterDataSum = dayWaterData.reduce(function(prev,cur,index,array){
                                    return prev + cur
                                })
                                //根据业务自己拓展要显示的内容
                                let res = "";//tips显示内容
                                let installNum;   //安装量
                                let onlineNum; //在线量
                                 $.ajax({   
                                    url:'/DataDisplay/OnLine/GetBranchCompanyOnlineRate',
                                    type: "get",
                                    async: false, //同步
                                    success: function (data) {
                                        let jsonData = JSON.parse(data).Series;
                                        jsonData.forEach(function(item,i){
                                            if(item.Name == params.name){
                                                installNum = item.Install;
                                                onlineNum = item.OnLine;
                                            }
                                        })
                                    }
                                });
                                res = params.marker+params.name +"<br>用 水 量："+dayWaterDataSum+"吨<br>安装数量："+installNum+"<br>在线数量："+onlineNum+""
                                return res;
                            }
                        },
                        geo: {
                            map: 'xiqing', 
                            zoom: 1.2,
                            itemStyle: { //地图区域的多边形 图形样式
                                normal: { //是图形在默认状态下的样式
                                    label: {
                                        show: true, //是否显示标签
                                        textStyle: {
                                            color: 'transparent'
                                        },
                                    },
                                    borderWidth: 2,
                                    borderColor: '#12dff6', //地图边线颜色
                                    areaColor: 'rgba(33,51,99,0.8)',
                                },
                                emphasis: { //是图形在高亮状态下的样式,比如在鼠标悬浮或者图例联动高亮时
                                    label: {
                                        show: false,
                                        textStyle: {
                                            color: 'transparent'
                                        },
                                    },
                                    borderColor: '#12dff6',
                                    areaColor: 'rgba(33,51,99,0.65)',
                                }
                            }
                        },
                        series: [
                            {
                                type: 'effectScatter',
                                coordinateSystem: 'geo',
                                data: convertData(signData),
                                symbolSize: function(val) {
                                    return val[2] / 3;
                                },
                                showEffectOn: 'render',
                                rippleEffect: {
                                    brushType: 'stroke'
                                },
                                hoverAnimation: true,
                                label: { //标记文字
                                    normal: {
                                        formatter: '{b}',
                                        position: 'bottom',
                                        color:'#3cdbd5',
                                        show: true
                                    }
                                },
                                itemStyle: { //标记点
                                    normal: {
                                        color: '#10f9ff',
                                        shadowBlur: 0,
                                        shadowColor: '#05C3F9'
                                    },
                                },
                                zlevel: 1
                            }, 
                        ]
                    };
                    mapChart.setOption(option);
                }
            }
        });

        //跳转二级地图
        mapChart.on('click',function(param){
            if(param.data){
                let mapName = param.data.name
                allCorporateArr.forEach(function(item,index){
                    if(mapName == item.CNAME){
                        let urlMenu = "menu"+item.COMPANYID+""; //根据id进行跳转
                        location.href = "/DataDisplay/Main/Secondary?id="+urlMenu+"";
                    }
                });
            }
        })
        ///总用水量
        $.ajax({
            url: "/DataDisplay/Main/GetTotalWater",
            type: "get",
            async: true,
            success: function (data) {
                $("#TotalWater").text(data);
            }
        });

        //总安装数量
        $.ajax({
            url: "/DataDisplay/Main/GetAllInstallAmount",
            type: "get",
            async: true,
            success: function (data) {
                $("#total-install").text(data);
            }
        });

        //总在线数量
        $.ajax({
            url: "/DataDisplay/Main/GetOnlineAmount",
            type: "get",
            async: true,
            success: function (data) {
                $("#total-online").text(data);
            }
        });
        //总离线数量
        $.ajax({
            url: "/DataDisplay/Main/GetOfflineAmount",
            type: "get",
            async: true,
            success: function (data) {
                $("#total-offline").text(data);
            }
        });

        //总报警数量
        $.ajax({
            url: "/DataDisplay/Main/GetAllAlram",
            type: "get",
            async: true,
            success: function (data) {
                $("#total-alarm").text(data);
            }
        });

        ///用水分析
        var waterChartTitle = "";
        var waterlegendData = [], HourWaterData = [];
        $.ajax({
            url: "/DataDisplay/Main/GetMainHourWater",
            type: "get",
            async: false,
            success: function (data) {
                var JsonData = JSON.parse(data);
                waterChartTitle = JsonData["Title"];//用水量图表标题
                $.each(JsonData["Series"], function (i, ele) {
                    waterlegendData.push(ele.Name);
                    HourWaterData[i] = new Array();
                    $.each(ele.Data, function (j, wele) {
                        HourWaterData[i].push(wele);
                    });
                    //在线率名称(暂用)
                    if(i>0 && i<JsonData.Series.length-1){
                        OnlineName.push(ele.Name)
                    }
                });
                //绘制图表
                waterChart.setOption({
                    title: {
                        text: waterChartTitle,
                        textStyle: {
                            color: '#fff',
                            fontStyle: 'normal',
                            fontWeight: 'normal'
                        }
                    },
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                            type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    legend: {
                        data: waterlegendData,
                        x: 'right',
                        textStyle: {
                            color: '#fff',
                            fontSize: 16
                        }
                    },
                    grid: {
                        left: '1%',
                        right: '1%',
                        bottom: '2%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'category',
                        data: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24'],
                        axisLine: {
                            lineStyle: {
                                color: '#0d346e'
                            }
                        },
                        axisLabel: {
                            interval: 0,//强制文字产生间隔
                            textStyle: {
                                color: '#59588D',
                                fontSize:12,
                            }
                        },
                    
                    },
                    yAxis: {
                        type: 'value',
                        axisLabel: {
                            formatter: '{value}万吨',
                            textStyle: {
                                color: '#59588D',
                                fontSize:12,
                            }
                        },
                        axisLine: {
                            lineStyle: {
                                color: '#0d346e'
                            }
                        },
                        //网格样式
                        splitLine: {
                            show: true,
                            lineStyle: {
                                color: ['#0d346e'],
                                width: 1,
                                type: 'solid'
                            }
                        }
                    },
                    series: [
                        {
                            name: waterlegendData[0],
                            type: 'line',
                            smooth: true,
                            label: {
                                normal: {
                                    show: true,
                                    position: 'insideRight'
                                }
                            },
                            itemStyle: { color: "#e24e8c" },
                            data: HourWaterData[0]
                        },
                        {
                            name: waterlegendData[1],
                            type: 'bar',
                            stack: '用水量',
                            label: {
                                normal: {
                                    show: true,
                                    position: 'insideRight'
                                }
                            },
                            itemStyle: { color: "#069684" },
                            data: HourWaterData[1]
                        },
                        {
                            name: waterlegendData[2],
                            type: 'bar',
                            stack: '用水量',
                            label: {
                                normal: {
                                    show: true,
                                    position: 'insideRight'
                                }
                            },
                            itemStyle: { color: "#5d7cfe" },
                            data: HourWaterData[2]
                        }
                        ,
                        {
                            name: waterlegendData[3],
                            type: 'bar',
                            stack: '用水量',
                            label: {
                                normal: {
                                    show: true,
                                    position: 'insideRight'
                                }
                            },
                           // itemStyle: { color: "#889efb" },
                            itemStyle: { color: "#88c977" },
                            data: HourWaterData[3]
                        }
                    ]
                });
            }
        });




        ///信号强度对比
        var SignalChartTitle = "";
        var SignalegendData = [], SignalData = [];
        $.ajax({
            url: "/DataDisplay/Main/GetSignalStreng",
            type: "get",
            async: false,
            success: function (data) {
                var JsonData = JSON.parse(data);
                SignalChartTitle = JsonData["Title"];//用水量图表标题
                //获取图例
                $.each(JsonData["Series"], function (i, ele) {
                    SignalegendData.push(ele.Name);
                })
                //饼图数据
                SignalData = JSON.parse(JSON.stringify(JsonData["Series"]).toLowerCase());

                //绘制图表
                RSSIChart.setOption({
                    color: ["#f39d77", "#34db9a", "#2ca9e1", "#4466f4", "#eb6d71", "#f77d76", "#ed7791", "#c1e4e8", "#3dceed", "#4d6eb8", "#84a2d4", "#d7abea", "#093e99", "#f8b861", "#f9e58c"],

                    grid: {
                        left: -100,
                        top: 50,
                        bottom: 10,
                        right: 10,
                        containLabel: true
                    },
                    tooltip: {
                        trigger: 'item',
                        formatter: "{b} : {c} ({d}%)"
                    },
                    legend: {
                        type: "scroll",
                        orient: "vartical",
                        top: "center",
                        right: "15",
                        itemWidth: 16,
                        itemHeight: 8,
                        itemGap: 16,
                        textStyle: {
                            color: '#A3E2F4',
                            fontSize: 12,
                            fontWeight: 0
                        },
                        data: SignalegendData
                    },
                    polar: {},
                    angleAxis: {
                        interval: 1,
                        type: 'category',
                        data: [],
                        z: 10,
                        axisLine: {
                            show: false,
                            lineStyle: {
                                color: "#0B4A6B",
                                width: 1,
                                type: "solid"
                            },
                        },
                        axisLabel: {
                            interval: 0,
                            show: true,
                            color: "#0B4A6B",
                            margin: 8,
                            fontSize: 16
                        },
                    },
                    radiusAxis: {
                        min: 40,
                        max: 120,
                        interval: 20,
                        axisLine: {
                            show: false,
                            lineStyle: {
                                color: "#0B3E5E",
                                width: 1,
                                type: "solid"
                            },
                        },
                        axisLabel: {
                            formatter: '{value} %',
                            show: false,
                            padding: [0, 0, 20, 0],
                            color: "#0B3E5E",
                            fontSize: 16
                        },
                        splitLine: {
                            lineStyle: {
                                color: "#0B3E5E",
                                width: 2,
                                type: "solid"
                            }
                        }
                    },
                    calculable: true,
                    series: [{
                        type: 'pie',
                        radius: ["5%", "10%"],
                        hoverAnimation: false,
                        labelLine: {
                            normal: {
                                show: false,
                                length: 30,
                                length2: 55
                            },
                            emphasis: {
                                show: false
                            }
                        },
                        data: [{
                            name: '',
                            value: 0,
                            itemStyle: {
                                normal: {
                                    color: "#0B4A6B"
                                }
                            }
                        }]
                    }, {
                        type: 'pie',
                        radius: ["90%", "95%"],
                        hoverAnimation: false,
                        labelLine: {
                            normal: {
                                show: false,
                                length: 30,
                                length2: 55
                            },
                            emphasis: {
                                show: false
                            }
                        },
                        name: "",
                        data: [{
                            name: '',
                            value: 0,
                            itemStyle: {
                                normal: {
                                    color: "#0B4A6B"
                                }
                            }
                        }]
                    },{
                        stack: 'a',
                        type: 'pie',
                        radius: ['20%', '80%'],
                        roseType: 'area',
                        zlevel:10,
                        label: {
                            normal: {
                                show: true,
                                formatter: "{c}",
                                textStyle: {
                                    fontSize: 12,
                                },
                                position: 'outside'
                            },
                            emphasis: {
                                show: true
                            }
                        },
                        labelLine: {
                            normal: {
                                show: true,
                                length: 20,
                                length2: 55
                            },
                            emphasis: {
                                show: false
                            }
                        },
                        data: SignalData
                    }, ]
                });
            }
        });
        
       
        ///报警
        var AlarmChartTitle = "";
        var AlarmlegendData = [], AlarmData = [];
        $.ajax({
            url: "/DataDisplay/Main/GetAlram",
            type: "get",
            async: false,
            success: function (data) {
                var JsonData = JSON.parse(data);
                AlarmChartTitle = JsonData["Title"];//用水量图表标题
                $.each(JsonData["Series"], function (i, ele) {
                    AlarmlegendData.push(ele.Name);
                    AlarmData.push(ele.Value);
                });
                //绘制图表
                alarmChart.setOption({
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {           
                            type: 'shadow'       
                        }
                    },
                    legend: {
                        data: waterlegendData,
                        x: 'right',
                        textStyle: {
                            color: '#fff',
                            fontSize: 16
                        }
                    },
                    grid: {
                        left: '1%',
                        right: '3%',
                        bottom: '2%',
                        top: '18%',
                        containLabel: true
                    },
                    xAxis: {
                        data:AlarmlegendData,
                        show: true,
                        axisLabel: {
                            interval: 0,//强制文字产生间隔
                            formatter:function (value){ //回调函数,文字超出显示...
                                let valueTxt = '';
                                if (value.length > 4) {
                                    valueTxt = value.substring(0, 4) + '...';
                                }
                                else {
                                    valueTxt = value;
                                }
                                return valueTxt ;
                            },
                            textStyle: {
                                color: '#59588D',
                                fontSize:12,
                            }
                        },
                        axisLine: {
                            lineStyle: {
                                color: '#0d346e'
                            }
                        },
                    },
                    yAxis: {
                        axisLabel: {
                            formatter: '{value}条',
                            color: '#59588D',
                        },
                        axisLine: {
                            lineStyle: {
                                color: '#0d346e'
                            }
                        },
                        //网格
                        splitLine: {
                            lineStyle: {
                                color: '#0d346e'
                            }
                        }
                    },
                    series: [
                        {
                            type: 'bar',
                            data: AlarmData,
                            barWidth: '20px',
                            itemStyle: {
                                normal: {
                                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                                        offset: 0,
                                        color: '#41E1D4' // 0% 处的颜色
                                    }, {
                                        offset: 1,
                                        color: '#10A7DB' // 100% 处的颜色
                                    }], false),
                                    barBorderRadius: [30, 30, 0, 0],
                                    shadowColor: 'rgba(0,255,225,1)',
                                    shadowBlur: 4,
                                }
                            },
                            label: {
                                normal: {
                                    show: true,
                                    lineHeight: 30,
                                    width: 80,
                                    height: 30,
                                    backgroundColor: '#252453',
                                    borderRadius: 200,
                                    position: ['-8', '-60'],
                                    distance: 1,
                                    formatter: [
                                        '    {d|●}',
                                        ' {a|{c}}     \n',
                                        '    {b|}'
                                    ].join(','),
                                    rich: {
                                        d: {
                                            color: '#3CDDCF',
                                        },
                                        a: {
                                            color: '#fff',
                                            align: 'center',
                                        },
                                        b: {
                                            width: 1,
                                            height: 30,
                                            borderWidth: 1,
                                            borderColor: '#234e6c',
                                            align: 'left'
                                        },
                                    }
                                }
                            }
                        }
                    ]
                });
            }
        });
        


        //在线率
        $.ajax({
            url: "/DataDisplay/OnLine/GetBranchCompanyOnlineRate",
            type: "get",
            async: false,
            success: function (data) {
                var JsonData = JSON.parse(data);  
                //在线率计算
                let onlineRate0 = JsonData.Series[0].OnLine/JsonData.Series[0].Install;
                //let onlineRate1 = JsonData.Series[1].OnLine / JsonData.Series[1].Install;
                //let onlineRate2 = JsonData.Series[2].OnLine / JsonData.Series[2].Install;
                let onlineRate1 = 0;
                let onlineRate2 = 0;

                OnlineChart.setOption({
                    title: [
                        {
                            x: "10%",//标题位置
                            bottom: 10,
                            text: JsonData.Series[0].Name,
                            textStyle: {
                                fontWeight: 'normal',
                                fontSize: 14,
                                color: "#fff"
                            },
                        }, 
                        {
                            x: "42%",
                            bottom: 10,
                            text: JsonData.Series[1].Name,
                            textStyle: {
                                fontWeight: 'normal',
                                fontSize: 14,
                                color: "#fff",
                            },
                        }, 
                        {
                            x: "75%",
                            bottom: 10,
                            text: JsonData.Series[2].Name,
                            textStyle: {
                                fontWeight: 'normal',
                                fontSize: 14,
                                color: "#fff"
                            },
                        }
                    ],
                    tooltip: {
                        formatter: "{a}: {b}",
                        textStyle: {
                            color: "#fff",
                            fontSize: 14
                        },
                    },
                    series: [
                        {
                            center: ["18.3%", "60%"], //左边
                            radius: "50%",
                            min: 0,
                            max: 100,
                            splitNumber: 5,  //显示数
                            axisLine: {
                                lineStyle: {
                                    color: [
                                        ["1", (function() {
                                            return new echarts.graphic.LinearGradient(0, 0, 1, 0, [{
                                                offset: 0,
                                                color: '#a2c65d'
                                            }, {
                                                offset: 1,
                                                color: '#00d5ff'
                                            }]);
                                        })()],
                                    ],
                                    width: 8,
                                    fontSize: 14,
                                    shadowColor: "rgba(0, 213, 255,1)",
                                    shadowBlur: 5,
                                }
                            },
                            axisTick: {
                                length: 10,
                                lineStyle: {
                                    width: 1
                                },
                                alignWithLabel: false
                            },
                            axisLabel: { //刻度值
                                textStyle: {
                                    color: "#00d5ff",
                                    fontSize: 14
                                },
                                distance: 8
                            },
                            splitLine: {  //刻度线
                                lineStyle: {
                                    width: 2
                                },
                                length: 13
                            },
                            pointer: { //指针
                                length: "70%",
                                width: 10
                            },
                            title: { //表盘显示文字（百分比）
                                fontWeight: "bolder",
                                fontSize: 14,
                                color: "#fff",
                                fontStyle: "italic",
                                padding:[140,0,0,0] //显示位置
                            },
                            detail: {show:false},
                            name: JsonData.Series[0].Name,
                            type: "gauge",
                            z: 3,
                            data: [{
                                value: toPercent(onlineRate0),
                                name: toPercent(onlineRate0)+"%",
                            }]
                        }, 
                        {
                            center: ["50%", "30%"], //中间
                            radius: "52%",
                            min: 0,
                            max: 100,
                            splitNumber: 5,
                            axisLine: {
                                lineStyle: {
                                    color: [
                                        ["1", (function() {
                                            return new echarts.graphic.LinearGradient(0, 0, 1, 0, [{
                                                offset: 0,
                                                color: '#00d5ff'
                                            },{
                                                offset: 0.5,
                                                color: '#a2c65d'
                                            },{
                                                offset: 1,
                                                color: '#00d5ff'
                                            }]);
                                        })()],
                                    ],
                                    width: 8,
                                    fontSize: 14,
                                    shadowColor: "rgba(0, 213, 255,1)",
                                    shadowBlur: 5,
                                }
                            },
                            axisTick: {
                                length: 10,
                                lineStyle: {
                                    width: 1
                                },
                                alignWithLabel: false
                            },
                            axisLabel: {
                                textStyle: {
                                    color: "#00d5ff",
                                    fontSize: 14
                                },
                                distance: 5
                            },
                            splitLine: {
                                lineStyle: {
                                    width: 2
                                },
                                length: 13
                            },
                            pointer: {
                                length: "70%",
                                width: 10
                            },
                            title: {
                                fontWeight: "bolder",
                                fontSize: 14,
                                color: "#fff",
                                fontStyle: "italic",
                                padding:[150,0,0,0] //显示位置
                            },
                            detail: {show: false,},
                            name: JsonData.Series[1].Name,
                            type: "gauge",
                            z: 3,
                            data: [{
                                value: toPercent(onlineRate1),
                                name: toPercent(onlineRate1)+"%"
                            }]
                        },
                        {
                            center: ["81.7%", "60%"],//右边
                            radius: "50%",
                            min: 0,
                            max: 100,
                            splitNumber: 5,
                            axisLine: {
                                lineStyle: {
                                    color: [
                                        ["1", (function() {
                                            return new echarts.graphic.LinearGradient(0, 0, 1, 0, [{
                                                offset: 0,
                                                color: '#00d5ff'
                                            }, {
                                                offset: 1,
                                                color: '#a2c65d'
                                            }]);
                                        })()],
                                    ],
                                    width: 8,
                                    fontSize: 10,
                                    shadowColor: "rgba(0, 213, 255,1)",
                                    shadowBlur: 5,
                                }
                            },
                            axisTick: {
                                length: 10,
                                lineStyle: {
                                    width: 1
                                },
                                alignWithLabel: false
                            },
                            axisLabel: {
                                textStyle: {
                                    color: "#00d5ff",
                                    fontSize: 14
                                },
                                distance: 5
                            },
                            splitLine: {
                                lineStyle: {
                                    width: 2
                                },
                                length: 13
                            },
                            pointer: {
                                length: "70%",
                                width: 10
                            },
                            title: {
                                fontWeight: "bolder",
                                fontSize: 14,
                                color: "#fff",
                                fontStyle: "italic",
                                padding:[140,0,0,0] //显示位置
                            },
                            detail: {show:false},
                            name: JsonData.Series[2].Name,
                            type: "gauge",
                            z: 3,
                            data: [{
                                value: toPercent(onlineRate2),
                                name: toPercent(onlineRate2)+"%",
                            }]
                        }
                    ]
                });
            }
        });
    })

    function toPercent(point){
        var str=Number(point*100).toFixed(2);
        return str;
    } 

    window.onresize = function () {
        ///数据窗口变化后更新底部水量图表高度
        resizeWaterChart();
        RSSIChart.resize();
        OnlineChart.resize();
        alarmChart.resize();
        waterChart.resize();
        mapChart.resize();
    }
    ///动态修改底部用水量图表高度
    function resizeWaterChart() {
        var waterChartH = $(window).height() - 680;
        $("#waterChart").height(waterChartH);
    }
</script>
